{"version":"5","defaultTimeframe":{"from":"now-1h","to":"now","details":{"from":{"type":"expression","normalized":"now-1h","date":"2024-04-12T18:59:53.271Z"},"to":{"type":"expression","normalized":"now","date":"2024-04-12T19:59:53.271Z"}}},"sections":[{"id":"intro-answers","type":"markdown","markdown":"# Metrics Lab: Answers\n\nThis notebook contains the **answers** to the Metrics Lab exercises. Use this as a reference after attempting the exercises yourself."},{"id":"557641e0-92ab-4860-af94-09a0334aebf3","type":"dql","title":"Answer 1: Chart Top 10 Hosts by CPU Usage","showTitle":true,"state":{"input":{"value":"timeseries cpu=avg(dt.host.cpu.usage), by:{dt.entity.host}\n| sort arrayAvg(cpu), direction:\"descending\"\n| limit 10","timeframe":{"from":"now-1h","to":"now","details":{"from":{"type":"expression","normalized":"now-1h","date":"2024-04-12T18:59:45.067Z"},"to":{"type":"expression","normalized":"now","date":"2024-04-12T19:59:45.067Z"}}}},"visualization":"lineChart","visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{},"categoricalBarChartSettings":{"categoryAxis":"dt.entity.host","categoryAxisLabel":"dt.entity.host","valueAxis":"interval","valueAxisLabel":"interval"},"fieldMapping":{"timestamp":"timeframe","leftAxisValues":["cpu"],"leftAxisDimensions":["dt.entity.host"]}},"singleValue":{"showLabel":true,"label":"","prefixIcon":"","recordField":"dt.entity.host","autoscale":true,"alignment":"center","colorThresholdTarget":"value"},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"lineWrapIds":[],"firstVisibleRowIndex":0,"columnWidths":{}},"histogram":{"dataMappings":[{"valueAxis":"interval","rangeAxis":""}]},"honeycomb":{"shape":"square"}}}},{"id":"a50208d8-1bee-4b77-ae74-e9c6f25466d4","type":"dql","title":"Answer 2: Basic CPU Timeseries","showTitle":true,"state":{"input":{"value":"timeseries avg(dt.host.cpu.usage), by:{dt.entity.host}","timeframe":{"from":"now-1h","to":"now","details":{"from":{"type":"expression","normalized":"now-1h","date":"2024-04-12T18:59:53.271Z"},"to":{"type":"expression","normalized":"now","date":"2024-04-12T19:59:53.271Z"}}}},"visualization":"lineChart","visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{},"categoricalBarChartSettings":{"categoryAxis":"dt.entity.host","valueAxis":"interval","categoryAxisLabel":"dt.entity.host","valueAxisLabel":"interval"},"fieldMapping":{"timestamp":"timeframe","leftAxisValues":["avg(dt.host.cpu.usage)"],"leftAxisDimensions":["dt.entity.host"],"rightAxisDimensions":[]}},"singleValue":{"showLabel":true,"label":"","prefixIcon":"","autoscale":true,"alignment":"center","colorThresholdTarget":"value","recordField":"dt.entity.host"},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"lineWrapIds":[],"firstVisibleRowIndex":0,"columnWidths":{}},"histogram":{"dataMappings":[{"valueAxis":"interval","rangeAxis":""}]},"honeycomb":{"shape":"square"}}}},{"id":"disk-space-intro","type":"markdown","markdown":"## Disk Space Monitoring\n\nMonitoring disk space is critical for preventing outages. The query below shows hosts sorted by least free space first, helping you identify potential issues before they become critical."},{"id":"disk-space-answer","type":"dql","title":"Answer 3: Monitor Disk Free Space","showTitle":true,"state":{"input":{"value":"timeseries disk=avg(dt.host.disk.free), by:{dt.entity.host}\n| sort arrayAvg(disk)\n| limit 5","timeframe":{"from":"now-1h","to":"now"}},"visualization":"lineChart","visualizationSettings":{"chartSettings":{"gapPolicy":"connect","fieldMapping":{"timestamp":"timeframe","leftAxisValues":["disk"],"leftAxisDimensions":["dt.entity.host"]},"leftYAxis":{"label":"Disk Free %"}},"table":{"rowDensity":"condensed"}}}},{"id":"custom-interval-intro","type":"markdown","markdown":"## Custom Time Intervals\n\nThe `interval` parameter controls the granularity of timeseries data. Smaller intervals provide more detail but more data points, while larger intervals smooth out variations."},{"id":"custom-interval-answer-5m","type":"dql","title":"Answer 4a: Custom Time Intervals (5-minute buckets)","showTitle":true,"state":{"input":{"value":"timeseries cpu=avg(dt.host.cpu.usage), by:{dt.entity.host}, interval:5m\n| limit 5","timeframe":{"from":"now-2h","to":"now"}},"visualization":"lineChart","visualizationSettings":{"chartSettings":{"gapPolicy":"connect","fieldMapping":{"timestamp":"timeframe","leftAxisValues":["cpu"],"leftAxisDimensions":["dt.entity.host"]},"leftYAxis":{"label":"CPU Usage %"}},"table":{"rowDensity":"condensed"}}}},{"id":"custom-interval-answer-15m","type":"dql","title":"Answer 4b: Custom Time Intervals (15-minute buckets)","showTitle":true,"state":{"input":{"value":"timeseries cpu=avg(dt.host.cpu.usage), by:{dt.entity.host}, interval:15m\n| limit 5","timeframe":{"from":"now-2h","to":"now"}},"visualization":"lineChart","visualizationSettings":{"chartSettings":{"gapPolicy":"connect","fieldMapping":{"timestamp":"timeframe","leftAxisValues":["cpu"],"leftAxisDimensions":["dt.entity.host"]},"leftYAxis":{"label":"CPU Usage %"}},"table":{"rowDensity":"condensed"}}}}]}