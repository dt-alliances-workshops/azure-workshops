{"version":"5","defaultTimeframe":{"from":"now-1h","to":"now","details":{"from":{"type":"expression","normalized":"now-1h","date":"2024-04-12T18:59:53.271Z"},"to":{"type":"expression","normalized":"now","date":"2024-04-12T19:59:53.271Z"}}},"sections":[{"id":"intro-learning","type":"markdown","markdown":"# Metrics Lab: Working with Timeseries Data\n\n## Learning Exercise\n\nThis notebook contains **exercises** to help you learn DQL for metrics. Each section provides hints to help you construct the query yourself.\n\n**Timeseries Quick Reference:**\n\n| Command | Description | Example |\n|---------|-------------|---------|\n| timeseries | Create time-based data | timeseries avg(dt.host.cpu.usage) |\n| by:{} | Group by entity | by:{dt.entity.host} |\n| sort | Order results | sort arrayAvg(cpu), direction:\"descending\" |\n| limit | Restrict output | limit 10 |\n| fields | Select columns | fields metric, entity, interval |\n\n**Tip:** Try writing each query yourself before checking the answers notebook!"},{"id":"557641e0-92ab-4860-af94-09a0334aebf3","type":"dql","title":"Exercise 1: Chart Top 10 Hosts by CPU Usage","showTitle":true,"state":{"input":{"value":"// EXERCISE 1: Chart Top 10 Hosts by CPU Usage\n// \n// Goal: Create a timeseries showing CPU usage, sorted to show top 10 hosts\n// \n// Hints:\n// - Use timeseries command for time-based metrics\n// - Syntax: timeseries <alias>=<aggregation>(<metric>), by:{<entity>}\n// - Metric: dt.host.cpu.usage\n// - Entity: dt.entity.host\n// - Use | sort arrayAvg(<alias>), direction:\"descending\" to sort\n// - Use | limit 10 to show top 10\n// \n// Write your query below:\n","timeframe":{"from":"now-1h","to":"now","details":{"from":{"type":"expression","normalized":"now-1h","date":"2024-04-12T18:59:45.067Z"},"to":{"type":"expression","normalized":"now","date":"2024-04-12T19:59:45.067Z"}}}},"visualization":"lineChart","state":"success","visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{},"categoricalBarChartSettings":{"categoryAxis":"dt.entity.host","categoryAxisLabel":"dt.entity.host","valueAxis":"interval","valueAxisLabel":"interval"},"fieldMapping":{"timestamp":"timeframe","leftAxisValues":["cpu"],"leftAxisDimensions":["dt.entity.host"]}},"singleValue":{"showLabel":true,"label":"","prefixIcon":"","recordField":"dt.entity.host","autoscale":true,"alignment":"center","colorThresholdTarget":"value"},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"lineWrapIds":[],"firstVisibleRowIndex":0,"columnWidths":{}},"histogram":{"dataMappings":[{"valueAxis":"interval","rangeAxis":""}]},"honeycomb":{"shape":"square"}}}},{"id":"a50208d8-1bee-4b77-ae74-e9c6f25466d4","type":"dql","title":"Exercise 2: Basic CPU Timeseries","showTitle":true,"state":{"input":{"value":"// EXERCISE 2: Basic CPU Timeseries\n// \n// Goal: Create a simple timeseries of CPU usage per host\n// \n// Hints:\n// - Use timeseries command\n// - Aggregation: avg()\n// - Metric: dt.host.cpu.usage\n// - Group by: dt.entity.host\n// \n// Write your query below:\n","timeframe":{"from":"now-1h","to":"now","details":{"from":{"type":"expression","normalized":"now-1h","date":"2024-04-12T18:59:53.271Z"},"to":{"type":"expression","normalized":"now","date":"2024-04-12T19:59:53.271Z"}}}},"visualization":"lineChart","state":"success","visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{},"categoricalBarChartSettings":{"categoryAxis":"dt.entity.host","valueAxis":"interval","categoryAxisLabel":"dt.entity.host","valueAxisLabel":"interval"},"fieldMapping":{"timestamp":"timeframe","leftAxisValues":["avg(dt.host.cpu.usage)"],"leftAxisDimensions":["dt.entity.host"],"rightAxisDimensions":[]}},"singleValue":{"showLabel":true,"label":"","prefixIcon":"","autoscale":true,"alignment":"center","colorThresholdTarget":"value","recordField":"dt.entity.host"},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"lineWrapIds":[],"firstVisibleRowIndex":0,"columnWidths":{}},"histogram":{"dataMappings":[{"valueAxis":"interval","rangeAxis":""}]},"honeycomb":{"shape":"square"}}}},{"id":"aa9653b6-bb15-4c8d-9801-f5dfb2b006d7","type":"markdown","markdown":"## Forecasting Metrics\n\n- In the section below we'll use CPU Metrics we've collected for the VM hosts in our lab. \n- Next we'll run the Davis Analyzer to predict how the CPU utilization of the host will be for the host.  \n\n### Here are the instructions to predict the CPU utilization.  \n - Select the next section of the Notebook and \n - Click on **Run Analysis** to run the DQL query and Davis Analyzer on the host metrics\n - For the timeframe select **Last 2 Hours** \n   - To view how to turn on Davis Analyzer for predictions, click on Options button, click on Davis AI at the bottom\n   - On the next screen you'll notice we are using the **Forecast** Analyzer\n - On the chart you'll notice blue shading that shows above & below the line.  \n   - Based on the metrics, Davis is predicting the CPU utilization to within that blue shade for this host. \n \n   "},{"id":"bbbd93f2-5257-4793-bbc4-69b75077b7e1","type":"dql","title":"Exercise 3: Prepare Data for Forecasting","showTitle":true,"showInput":true,"state":{"input":{"value":"// EXERCISE 3: Prepare Data for Forecasting\n// \n// Goal: Create a timeseries query with specific fields for Davis AI forecasting\n// \n// Hints:\n// - Start with a timeseries query for CPU usage by host\n// - Use | fields to select specific columns\n// - Required fields for forecasting visualization:\n//   - The metric value (e.g., avg(dt.host.cpu.usage))\n//   - dt.entity.host\n//   - interval\n//   - timeframe\n// - Note: Field names with special chars need backticks\n// \n// Write your query below:\n","timeframe":{"from":"now-2h","to":"now","details":{"from":{"type":"expression","normalized":"now-2h","date":"2024-04-12T16:40:51.357Z"},"to":{"type":"expression","normalized":"now","date":"2024-04-12T18:40:51.357Z"}}}},"visualization":"davis","state":"success","visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{},"categoricalBarChartSettings":{"categoryAxis":"dt.entity.host","categoryAxisLabel":"dt.entity.host","valueAxis":"interval","valueAxisLabel":"interval"},"fieldMapping":{"timestamp":"timeframe","leftAxisValues":["avg(dt.host.disk.free)"],"leftAxisDimensions":["dt.entity.host"]}},"singleValue":{"showLabel":true,"label":"","prefixIcon":"","recordField":"dt.entity.host","autoscale":true,"alignment":"center","colorThresholdTarget":"value"},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"lineWrapIds":[],"firstVisibleRowIndex":0,"columnWidths":{}},"histogram":{"dataMappings":[{"valueAxis":"interval","rangeAxis":""}]},"honeycomb":{"shape":"square"}}}}]}